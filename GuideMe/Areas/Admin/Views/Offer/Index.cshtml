@model AllOffersResponse

<div class="container py-4">

    <!-- Header with Create Button -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h2 class="fw-bold mb-0">Offers List</h2>
        <a asp-action="Create" class="btn btn-sm btn-primary">
            <i class="bi bi-plus-lg"></i> Create New Offer
        </a>
    </div>

    <table class="table table-bordered table-hover table-soffered">
        <thead class="table-dark">
            <tr>
                <th>#</th>
                <th>Guide</th>
                <th>Trip</th>
                <th>Message</th>
                <th>Price</th>
                <th>Status</th>
                <th>Start</th>
                <th>End</th>
                <th>Actions</th>
            </tr>
        </thead>

        <tbody>
            @foreach (var item in Model.Offers)
            {
                <tr>
                    <td>@item.Id</td>
                    <td>@item.Guide.ApplicationUser?.UserName</td>
                    <td>
                        @if (@item.Trip.Title.Length<20)
                        {
                            @item.Trip?.Title
                        }
                        else
                        {
                          
                            @item.Trip?.Title.Substring(30);
                        }
                    </td>
                    <td>
                        @if (@item.Message.Length < 20)
                        {
                            @item.Message
                        }
                        else
                        {
                            @item.Message.Substring(10);
                           
                        }
                    </td>
                    <td>@item.OfferedPrice.ToString("C")</td>
                    <td>@item.Status</td>
                    <td>@item.OfferStartDate.ToShortDateString()</td>
                    <td>@item.OfferEndDate.ToShortDateString()</td>
                    <td>
                        <a asp-action="Edit" asp-route-id="@item.Id" class="btn btn-warning btn-sm">Edit</a>
                        <a href="javascript:void(0);"
                           onclick="confirmDelete('@Url.Action("Delete", "Offer", new { id = item.Id, area = "Admin" })')"
                           class="btn btn-danger btn-sm">
                            Delete
                        </a>
                    </td>
                </tr>
            }
        </tbody>
    </table>

    <!-- Pagination -->
    <nav class="mt-3" aria-label="pagination">
        <ul class="pagination pagination-sm justify-content-center mb-0">
            @if (Model.CurrentPage > 1)
            {
                <li class="page-item">
                    <a class="page-link" href="/admin/offer/index?page=@(Model.CurrentPage - 1)">
                        <i class="bi bi-chevron-left"></i>
                    </a>
                </li>
            }

            @for (var i = 1; i <= Model.PagesNumber; i++)
            {
                <li class="page-item @(Model.CurrentPage == i ? "active" : "")">
                    <a class="page-link" href="/admin/offer/index?page=@i">@i</a>
                </li>
            }

            @if (Model.CurrentPage < Model.PagesNumber)
            {
                <li class="page-item">
                    <a class="page-link" href="/admin/offer/index?page=@(Model.CurrentPage + 1)">
                        <i class="bi bi-chevron-right"></i>
                    </a>
                </li>
            }
        </ul>
    </nav>

</div>
@section Scripts {
    <script>
        function confirmDelete(deleteUrl) {
            Swal.fire({
                title: 'Are you sure?',
                text: "This offer will be deleted permanently!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#d33',
                cancelButtonColor: '#3085d6',
                confirmButtonText: 'Yes, delete it!',
                cancelButtonText: 'Cancel'
            }).then((result) => {
                if (result.isConfirmed) {
                    // Redirect to delete action
                    window.location.href = deleteUrl;
                }
            });
        }
    </script>
}
